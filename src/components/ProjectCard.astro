---
import { Image } from "astro:assets";

interface Props {
    className?: string;
    title: string;
    description?: string;
    slug: string;
    featuredImage?: string;
    featuredVideo?: string;
}

const { className, title, description, slug, featuredImage, featuredVideo } =
    Astro.props;

const isComingSoon = description === "Coming soon";
const getVideoType = (videoPath: string): string => {
    if (videoPath.endsWith(".webm")) return "video/webm";
    if (videoPath.endsWith(".mp4")) return "video/mp4";
    return "video/mp4";
};
---

<div class={`project-card ${className ?? ""}`}>
    <div class="project-card__background">
        {
            featuredVideo ? (
                <video
                    class="project-card__media project-card__media--video"
                    poster={featuredImage}
                    autoplay
                    loop
                    muted
                    playsinline
                >
                    <source
                        src={featuredVideo}
                        type={getVideoType(featuredVideo)}
                    />
                    {featuredImage && (
                        <img
                            src={featuredImage}
                            alt={title}
                            class="project-card__media project-card__media--image"
                        />
                    )}
                </video>
            ) : (
                featuredImage && (
                    <img
                        src={featuredImage}
                        alt={title}
                        class="project-card__media project-card__media--image"
                    />
                )
            )
        }
    </div>

    <div class="project-card__content">
        <div class="project-card__title">
            {
                isComingSoon ? (
                    <span class="project-card__link">{title}</span>
                ) : (
                    <a href={`/work/${slug}`} class="project-card__link">
                        {title}
                    </a>
                )
            }
        </div>

        {description && <div class="project-card__text">{description}</div>}
    </div>
</div>
